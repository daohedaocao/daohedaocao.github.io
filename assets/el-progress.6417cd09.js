import{a1 as ue,a as W,E as Q,e as L,o as f,g as F,y as A,l as E,m as p,u as e,z as J,t as B,j as S,h as _,k as de,A as h,n as j,B as z,ag as ce,r as G,G as pe,v as Ce,x as Ee,au as Y,T as Re,C as Se,p as ee,b as V,d as $,f as se,a3 as D,as as Te,S as fe,K as Fe,a$ as Pe,a8 as Le,aj as Z,b0 as De,w as ae,af as Ue,I as _e,N as Oe,D as oe}from"./index.d15ac50b.js";import{f as Ae,g as Be,b as Ie,d as Ne,a as Me,u as je,e as qe,E as ze}from"./el-overlay.b331af3f.js";import{E as q,_ as H,M as Ke,u as K,N as We,O as me,x as He,P as ve,d as ge,Q as Ve,R as Xe,S as Ge}from"./index.ac17342c.js";import{u as ye}from"./index.9afde902.js";import{F as Je,E as Qe}from"./focus-trap.b05075ab.js";import{u as Ye,i as Ze}from"./index.4af098ab.js";import{t as te,d as xe}from"./index.bff7b787.js";import{i as et}from"./isNil.98bb3b88.js";import{m as x}from"./typescript.72bf8adc.js";const tt=(...o)=>a=>{o.forEach(n=>{ue(n)?n(a):n.value=a})},he=Symbol("dialogInjectionKey"),be=Symbol("uploadContextKey"),st=["aria-label"],at=["id"],ot={name:"ElDialogContent"},nt=W({...ot,props:Ae,emits:Be,setup(o){const a=o,{t:n}=ye(),{Close:r}=Ke,{dialogRef:c,headerRef:d,bodyId:v,ns:g,style:C}=Q(he),{focusTrapRef:b}=Q(Je),u=tt(b,c),w=L(()=>a.draggable);return Ie(c,d,w),(s,t)=>(f(),F("div",{ref:e(u),class:p([e(g).b(),e(g).is("fullscreen",s.fullscreen),e(g).is("draggable",e(w)),{[e(g).m("center")]:s.center},s.customClass]),style:j(e(C)),tabindex:"-1",onClick:t[1]||(t[1]=z(()=>{},["stop"]))},[A("header",{ref_key:"headerRef",ref:d,class:p(e(g).e("header"))},[E(s.$slots,"header",{},()=>[A("span",{role:"heading",class:p(e(g).e("title"))},J(s.title),3)]),s.showClose?(f(),F("button",{key:0,"aria-label":e(n)("el.dialog.close"),class:p(e(g).e("headerbtn")),type:"button",onClick:t[0]||(t[0]=l=>s.$emit("close"))},[B(e(q),{class:p(e(g).e("close"))},{default:S(()=>[(f(),_(de(s.closeIcon||e(r))))]),_:1},8,["class"])],10,st)):h("v-if",!0)],2),A("div",{id:e(v),class:p(e(g).e("body"))},[E(s.$slots,"default")],10,at),s.$slots.footer?(f(),F("footer",{key:0,class:p(e(g).e("footer"))},[E(s.$slots,"footer")],2)):h("v-if",!0)],6))}});var lt=H(nt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog-content.vue"]]);const rt=["aria-label","aria-labelledby","aria-describedby"],it={name:"ElDialog"},ut=W({...it,props:Ne,emits:Me,setup(o,{expose:a}){const n=o,r=ce();Ye({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},L(()=>!!r.title));const c=K("dialog"),d=G(),v=G(),g=G(),{visible:C,titleId:b,bodyId:u,style:w,rendered:s,zIndex:t,afterEnter:l,afterLeave:y,beforeLeave:k,handleClose:m,onModalClick:T,onOpenAutoFocus:i,onCloseAutoFocus:U,onCloseRequested:O}=je(n,d);pe(he,{dialogRef:d,headerRef:v,bodyId:u,ns:c,rendered:s,style:w});const P=qe(T),I=L(()=>n.draggable&&!n.fullscreen);return a({visible:C,dialogContentRef:g}),(R,N)=>(f(),_(Se,{to:"body",disabled:!R.appendToBody},[B(Re,{name:"dialog-fade",onAfterEnter:e(l),onAfterLeave:e(y),onBeforeLeave:e(k),persisted:""},{default:S(()=>[Ce(B(e(ze),{"custom-mask-event":"",mask:R.modal,"overlay-class":R.modalClass,"z-index":e(t)},{default:S(()=>[A("div",{role:"dialog","aria-modal":"true","aria-label":R.title||void 0,"aria-labelledby":R.title?void 0:e(b),"aria-describedby":e(u),class:p(`${e(c).namespace.value}-overlay-dialog`),onClick:N[0]||(N[0]=(...M)=>e(P).onClick&&e(P).onClick(...M)),onMousedown:N[1]||(N[1]=(...M)=>e(P).onMousedown&&e(P).onMousedown(...M)),onMouseup:N[2]||(N[2]=(...M)=>e(P).onMouseup&&e(P).onMouseup(...M))},[B(e(Qe),{loop:"",trapped:e(C),"focus-start-el":"container",onFocusAfterTrapped:e(i),onFocusAfterReleased:e(U),onReleaseRequested:e(O)},{default:S(()=>[e(s)?(f(),_(lt,{key:0,ref_key:"dialogContentRef",ref:g,"custom-class":R.customClass,center:R.center,"close-icon":R.closeIcon,draggable:e(I),fullscreen:R.fullscreen,"show-close":R.showClose,title:R.title,onClose:e(m)},Y({header:S(()=>[R.$slots.title?E(R.$slots,"title",{key:1}):E(R.$slots,"header",{key:0,close:e(m),titleId:e(b),titleClass:e(c).e("title")})]),default:S(()=>[E(R.$slots,"default")]),_:2},[R.$slots.footer?{name:"footer",fn:S(()=>[E(R.$slots,"footer")])}:void 0]),1032,["custom-class","center","close-icon","draggable","fullscreen","show-close","title","onClose"])):h("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onReleaseRequested"])],42,rt)]),_:3},8,["mask","overlay-class","z-index"]),[[Ee,e(C)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"]))}});var dt=H(ut,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog.vue"]]);const rs=ee(dt),ct=V({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:o=>o>=0&&o<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:{type:Boolean,default:!1},duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:$(String),default:"round"},textInside:{type:Boolean,default:!1},width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:$([String,Array,Function]),default:""},format:{type:$(Function),default:o=>`${o}%`}}),pt=["aria-valuenow"],ft={viewBox:"0 0 100 100"},mt=["d","stroke","stroke-width"],vt=["d","stroke","opacity","stroke-linecap","stroke-width"],gt={key:0},yt={name:"ElProgress"},ht=W({...yt,props:ct,setup(o){const a=o,n={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},r=K("progress"),c=L(()=>({width:`${a.percentage}%`,animationDuration:`${a.duration}s`,backgroundColor:T(a.percentage)})),d=L(()=>(a.strokeWidth/a.width*100).toFixed(1)),v=L(()=>["circle","dashboard"].includes(a.type)?Number.parseInt(`${50-Number.parseFloat(d.value)/2}`,10):0),g=L(()=>{const i=v.value,U=a.type==="dashboard";return`
          M 50 50
          m 0 ${U?"":"-"}${i}
          a ${i} ${i} 0 1 1 0 ${U?"-":""}${i*2}
          a ${i} ${i} 0 1 1 0 ${U?"":"-"}${i*2}
          `}),C=L(()=>2*Math.PI*v.value),b=L(()=>a.type==="dashboard"?.75:1),u=L(()=>`${-1*C.value*(1-b.value)/2}px`),w=L(()=>({strokeDasharray:`${C.value*b.value}px, ${C.value}px`,strokeDashoffset:u.value})),s=L(()=>({strokeDasharray:`${C.value*b.value*(a.percentage/100)}px, ${C.value}px`,strokeDashoffset:u.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),t=L(()=>{let i;return a.color?i=T(a.percentage):i=n[a.status]||n.default,i}),l=L(()=>a.status==="warning"?We:a.type==="line"?a.status==="success"?me:He:a.status==="success"?ve:ge),y=L(()=>a.type==="line"?12+a.strokeWidth*.4:a.width*.111111+2),k=L(()=>a.format(a.percentage));function m(i){const U=100/i.length;return i.map((P,I)=>se(P)?{color:P,percentage:(I+1)*U}:P).sort((P,I)=>P.percentage-I.percentage)}const T=i=>{var U;const{color:O}=a;if(ue(O))return O(i);if(se(O))return O;{const P=m(O);for(const I of P)if(I.percentage>i)return I.color;return(U=P[P.length-1])==null?void 0:U.color}};return(i,U)=>(f(),F("div",{class:p([e(r).b(),e(r).m(i.type),e(r).is(i.status),{[e(r).m("without-text")]:!i.showText,[e(r).m("text-inside")]:i.textInside}]),role:"progressbar","aria-valuenow":i.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[i.type==="line"?(f(),F("div",{key:0,class:p(e(r).b("bar"))},[A("div",{class:p(e(r).be("bar","outer")),style:j({height:`${i.strokeWidth}px`})},[A("div",{class:p([e(r).be("bar","inner"),{[e(r).bem("bar","inner","indeterminate")]:i.indeterminate}]),style:j(e(c))},[(i.showText||i.$slots.default)&&i.textInside?(f(),F("div",{key:0,class:p(e(r).be("bar","innerText"))},[E(i.$slots,"default",{percentage:i.percentage},()=>[A("span",null,J(e(k)),1)])],2)):h("v-if",!0)],6)],6)],2)):(f(),F("div",{key:1,class:p(e(r).b("circle")),style:j({height:`${i.width}px`,width:`${i.width}px`})},[(f(),F("svg",ft,[A("path",{class:p(e(r).be("circle","track")),d:e(g),stroke:`var(${e(r).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-width":e(d),fill:"none",style:j(e(w))},null,14,mt),A("path",{class:p(e(r).be("circle","path")),d:e(g),stroke:e(t),fill:"none",opacity:i.percentage?1:0,"stroke-linecap":i.strokeLinecap,"stroke-width":e(d),style:j(e(s))},null,14,vt)]))],6)),(i.showText||i.$slots.default)&&!i.textInside?(f(),F("div",{key:2,class:p(e(r).e("text")),style:j({fontSize:`${e(y)}px`})},[E(i.$slots,"default",{percentage:i.percentage},()=>[i.status?(f(),_(e(q),{key:1},{default:S(()=>[(f(),_(de(e(l))))]),_:1})):(f(),F("span",gt,J(e(k)),1))])],6)):h("v-if",!0)],10,pt))}});var bt=H(ht,[["__file","/home/runner/work/element-plus/element-plus/packages/components/progress/src/progress.vue"]]);const kt=ee(bt),$t="ElUpload";class wt extends Error{constructor(a,n,r,c){super(a),this.name="UploadAjaxError",this.status=n,this.method=r,this.url=c}}function ne(o,a,n){let r;return n.response?r=`${n.response.error||n.response}`:n.responseText?r=`${n.responseText}`:r=`fail to ${a.method} ${o} ${n.status}`,new wt(r,n.status,a.method,o)}function Ct(o){const a=o.responseText||o.response;if(!a)return a;try{return JSON.parse(a)}catch{return a}}const Et=o=>{typeof XMLHttpRequest=="undefined"&&te($t,"XMLHttpRequest is undefined");const a=new XMLHttpRequest,n=o.action;a.upload&&a.upload.addEventListener("progress",d=>{const v=d;v.percent=d.total>0?d.loaded/d.total*100:0,o.onProgress(v)});const r=new FormData;if(o.data)for(const[d,v]of Object.entries(o.data))Array.isArray(v)?r.append(d,...v):r.append(d,v);r.append(o.filename,o.file,o.file.name),a.addEventListener("error",()=>{o.onError(ne(n,o,a))}),a.addEventListener("load",()=>{if(a.status<200||a.status>=300)return o.onError(ne(n,o,a));o.onSuccess(Ct(a))}),a.open(o.method,n,!0),o.withCredentials&&"withCredentials"in a&&(a.withCredentials=!0);const c=o.headers||{};if(c instanceof Headers)c.forEach((d,v)=>a.setRequestHeader(v,d));else for(const[d,v]of Object.entries(c))et(v)||a.setRequestHeader(d,String(v));return a.send(r),a},ke=["text","picture","picture-card"];let Rt=1;const $e=()=>Date.now()+Rt++,we=V({action:{type:String,default:"#"},headers:{type:$(Object)},method:{type:String,default:"post"},data:{type:Object,default:()=>x({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},type:{type:String,default:"select"},fileList:{type:$(Array),default:()=>x([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:ke,default:"text"},httpRequest:{type:$(Function),default:Et},disabled:Boolean,limit:Number}),St=V({...we,beforeUpload:{type:$(Function),default:D},beforeRemove:{type:$(Function)},onRemove:{type:$(Function),default:D},onChange:{type:$(Function),default:D},onPreview:{type:$(Function),default:D},onSuccess:{type:$(Function),default:D},onProgress:{type:$(Function),default:D},onError:{type:$(Function),default:D},onExceed:{type:$(Function),default:D}}),Tt=V({files:{type:$(Array),default:()=>x([])},disabled:{type:Boolean,default:!1},handlePreview:{type:$(Function),default:D},listType:{type:String,values:ke,default:"text"}}),Ft={remove:o=>!!o},Pt=["onKeydown"],Lt=["src"],Dt=["onClick"],Ut=["onClick"],_t=["onClick"],Ot={name:"ElUploadList"},At=W({...Ot,props:Tt,emits:Ft,setup(o,{emit:a}){const n=o,{t:r}=ye(),c=K("upload"),d=K("icon"),v=K("list"),g=G(!1),C=u=>{n.handlePreview(u)},b=u=>{a("remove",u)};return(u,w)=>(f(),_(Pe,{tag:"ul",class:p([e(c).b("list"),e(c).bm("list",u.listType),e(c).is("disabled",u.disabled)]),name:e(v).b()},{default:S(()=>[(f(!0),F(Fe,null,Te(u.files,s=>(f(),F("li",{key:s.uid||s.name,class:p([e(c).be("list","item"),e(c).is(s.status),{focusing:g.value}]),tabindex:"0",onKeydown:fe(t=>!u.disabled&&b(s),["delete"]),onFocus:w[0]||(w[0]=t=>g.value=!0),onBlur:w[1]||(w[1]=t=>g.value=!1),onClick:w[2]||(w[2]=t=>g.value=!1)},[E(u.$slots,"default",{file:s},()=>[u.listType==="picture"||s.status!=="uploading"&&u.listType==="picture-card"?(f(),F("img",{key:0,class:p(e(c).be("list","item-thumbnail")),src:s.url,alt:""},null,10,Lt)):h("v-if",!0),u.listType!=="picture"&&(s.status==="uploading"||u.listType!=="picture-card")?(f(),F("div",{key:1,class:p(e(c).be("list","item-info"))},[A("a",{class:p(e(c).be("list","item-name")),onClick:z(t=>C(s),["prevent"])},[B(e(q),{class:p(e(d).m("document"))},{default:S(()=>[B(e(Ve))]),_:1},8,["class"]),A("span",{class:p(e(c).be("list","item-file-name"))},J(s.name),3)],10,Dt),s.status==="uploading"?(f(),_(e(kt),{key:0,type:u.listType==="picture-card"?"circle":"line","stroke-width":u.listType==="picture-card"?6:2,percentage:Number(s.percentage),style:j(u.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):h("v-if",!0)],2)):h("v-if",!0),A("label",{class:p(e(c).be("list","item-status-label"))},[u.listType==="text"?(f(),_(e(q),{key:0,class:p([e(d).m("upload-success"),e(d).m("circle-check")])},{default:S(()=>[B(e(me))]),_:1},8,["class"])):["picture-card","picture"].includes(u.listType)?(f(),_(e(q),{key:1,class:p([e(d).m("upload-success"),e(d).m("check")])},{default:S(()=>[B(e(ve))]),_:1},8,["class"])):h("v-if",!0)],2),u.disabled?h("v-if",!0):(f(),_(e(q),{key:2,class:p(e(d).m("close")),onClick:t=>b(s)},{default:S(()=>[B(e(ge))]),_:2},1032,["class","onClick"])),h(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),h(" This is a bug which needs to be fixed "),h(" TODO: Fix the incorrect navigation interaction "),u.disabled?h("v-if",!0):(f(),F("i",{key:3,class:p(e(d).m("close-tip"))},J(e(r)("el.upload.deleteTip")),3)),u.listType==="picture-card"?(f(),F("span",{key:4,class:p(e(c).be("list","item-actions"))},[A("span",{class:p(e(c).be("list","item-preview")),onClick:t=>u.handlePreview(s)},[B(e(q),{class:p(e(d).m("zoom-in"))},{default:S(()=>[B(e(Xe))]),_:1},8,["class"])],10,Ut),u.disabled?h("v-if",!0):(f(),F("span",{key:0,class:p(e(c).be("list","item-delete")),onClick:t=>b(s)},[B(e(q),{class:p(e(d).m("delete"))},{default:S(()=>[B(e(Ge))]),_:1},8,["class"])],10,_t))],2)):h("v-if",!0)])],42,Pt))),128)),E(u.$slots,"append")]),_:3},8,["class","name"]))}});var le=H(At,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-list.vue"]]);const Bt=V({disabled:{type:Boolean,default:!1}}),It={file:o=>Le(o)},Nt=["onDrop","onDragover"],Mt={name:"ElUploadDrag"},jt=W({...Mt,props:Bt,emits:It,setup(o,{emit:a}){const n=o,r="ElUploadDrag",c=Q(be);c||te(r,"usage: <el-upload><el-upload-dragger /></el-upload>");const d=K("upload"),v=G(!1),g=b=>{if(n.disabled)return;v.value=!1;const u=Array.from(b.dataTransfer.files),w=c.accept.value;if(!w){a("file",u);return}const s=u.filter(t=>{const{type:l,name:y}=t,k=y.includes(".")?`.${y.split(".").pop()}`:"",m=l.replace(/\/.*$/,"");return w.split(",").map(T=>T.trim()).filter(T=>T).some(T=>T.startsWith(".")?k===T:/\/\*$/.test(T)?m===T.replace(/\/\*$/,""):/^[^/]+\/[^/]+$/.test(T)?l===T:!1)});a("file",s)},C=()=>{n.disabled||(v.value=!0)};return(b,u)=>(f(),F("div",{class:p([e(d).b("dragger"),e(d).is("dragover",v.value)]),onDrop:z(g,["prevent"]),onDragover:z(C,["prevent"]),onDragleave:u[0]||(u[0]=z(w=>v.value=!1,["prevent"]))},[E(b.$slots,"default")],42,Nt))}});var qt=H(jt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-dragger.vue"]]);const zt=V({...we,beforeUpload:{type:$(Function),default:D},onRemove:{type:$(Function),default:D},onStart:{type:$(Function),default:D},onSuccess:{type:$(Function),default:D},onProgress:{type:$(Function),default:D},onError:{type:$(Function),default:D},onExceed:{type:$(Function),default:D}}),Kt=["onKeydown"],Wt=["name","multiple","accept"],Ht={name:"ElUploadContent",inheritAttrs:!1},Vt=W({...Ht,props:zt,setup(o,{expose:a}){const n=o,r=K("upload"),c=Z({}),d=Z(),v=t=>{if(t.length===0)return;const{autoUpload:l,limit:y,fileList:k,multiple:m,onStart:T,onExceed:i}=n;if(y&&k.length+t.length>y){i(t,k);return}m||(t=t.slice(0,1));for(const U of t){const O=U;O.uid=$e(),T(O),l&&g(O)}},g=async t=>{if(d.value.value="",!n.beforeUpload)return C(t);let l;try{l=await n.beforeUpload(t)}catch{l=!1}if(l===!1){n.onRemove(t);return}let y=t;l instanceof Blob&&(l instanceof File?y=l:y=new File([l],t.name,{type:t.type})),C(Object.assign(y,{uid:t.uid}))},C=t=>{const{headers:l,data:y,method:k,withCredentials:m,name:T,action:i,onProgress:U,onSuccess:O,onError:P,httpRequest:I}=n,{uid:R}=t,N={headers:l||{},withCredentials:m,file:t,data:y,method:k,filename:T,action:i,onProgress:X=>{U(X,t)},onSuccess:X=>{O(X,t),delete c.value[R]},onError:X=>{P(X,t),delete c.value[R]}},M=I(N);c.value[R]=M,M instanceof Promise&&M.then(N.onSuccess,N.onError)},b=t=>{const l=t.target.files;!l||v(Array.from(l))},u=()=>{n.disabled||(d.value.value="",d.value.click())},w=()=>{u()};return a({abort:t=>{De(c.value).filter(t?([y])=>String(t.uid)===y:()=>!0).forEach(([y,k])=>{k instanceof XMLHttpRequest&&k.abort(),delete c.value[y]})},upload:g}),(t,l)=>(f(),F("div",{class:p([e(r).b(),e(r).m(t.listType),e(r).is("drag",t.drag)]),tabindex:"0",onClick:u,onKeydown:fe(z(w,["self"]),["enter","space"])},[t.drag?(f(),_(qt,{key:0,disabled:t.disabled,onFile:v},{default:S(()=>[E(t.$slots,"default")]),_:3},8,["disabled"])):E(t.$slots,"default",{key:1}),A("input",{ref_key:"inputRef",ref:d,class:p(e(r).e("input")),name:t.name,multiple:t.multiple,accept:t.accept,type:"file",onChange:b,onClick:l[0]||(l[0]=z(()=>{},["stop"]))},null,42,Wt)],42,Kt))}});var re=H(Vt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-content.vue"]]);const ie="ElUpload",Xt=o=>{var a;(a=o.url)!=null&&a.startsWith("blob:")&&URL.revokeObjectURL(o.url)},Gt=(o,a)=>{const n=Ze(o,"fileList",void 0,{passive:!0}),r=s=>n.value.find(t=>t.uid===s.uid);function c(s){var t;(t=a.value)==null||t.abort(s)}function d(s=["ready","uploading","success","fail"]){n.value=n.value.filter(t=>!s.includes(t.status))}const v=(s,t)=>{const l=r(t);!l||(console.error(s),l.status="fail",n.value.splice(n.value.indexOf(l),1),o.onError(s,l,n.value),o.onChange(l,n.value))},g=(s,t)=>{const l=r(t);!l||(o.onProgress(s,l,n.value),l.status="uploading",l.percentage=Math.round(s.percent))},C=(s,t)=>{const l=r(t);!l||(l.status="success",l.response=s,o.onSuccess(s,l,n.value),o.onChange(l,n.value))},b=s=>{const t={name:s.name,percentage:0,status:"ready",size:s.size,raw:s,uid:s.uid};if(o.listType==="picture-card"||o.listType==="picture")try{t.url=URL.createObjectURL(s)}catch(l){xe(ie,l.message),o.onError(l,t,n.value)}n.value.push(t),o.onChange(t,n.value)},u=async s=>{const t=s instanceof File?r(s):s;t||te(ie,"file to be removed not found");const l=y=>{c(y);const k=n.value;k.splice(k.indexOf(y),1),o.onRemove(y,k),Xt(y)};o.beforeRemove?await o.beforeRemove(t,n.value)!==!1&&l(t):l(t)};function w(){n.value.filter(({status:s})=>s==="ready").forEach(({raw:s})=>{var t;return s&&((t=a.value)==null?void 0:t.upload(s))})}return ae(()=>o.listType,s=>{s!=="picture-card"&&s!=="picture"||(n.value=n.value.map(t=>{const{raw:l,url:y}=t;if(!y&&l)try{t.url=URL.createObjectURL(l)}catch(k){o.onError(k,t,n.value)}return t}))}),ae(n,s=>{for(const t of s)t.uid||(t.uid=$e()),t.status||(t.status="success")},{immediate:!0,deep:!0}),{uploadFiles:n,abort:c,clearFiles:d,handleError:v,handleProgress:g,handleStart:b,handleSuccess:C,handleRemove:u,submit:w}},Jt={name:"ElUpload"},Qt=W({...Jt,props:St,setup(o,{expose:a}){const n=o,r=ce(),c=Ue(),d=Z(),{abort:v,submit:g,clearFiles:C,uploadFiles:b,handleStart:u,handleError:w,handleRemove:s,handleSuccess:t,handleProgress:l}=Gt(n,d),y=L(()=>n.listType==="picture-card"),k=L(()=>({...n,onStart:u,onProgress:l,onSuccess:t,onError:w,onRemove:s}));return _e(()=>{b.value.forEach(({url:m})=>{m!=null&&m.startsWith("blob:")&&URL.revokeObjectURL(m)})}),pe(be,{accept:Oe(n,"accept")}),a({abort:v,submit:g,clearFiles:C,handleStart:u,handleRemove:s}),(m,T)=>(f(),F("div",null,[e(y)&&m.showFileList?(f(),_(le,{key:0,disabled:e(c),"list-type":m.listType,files:e(b),"handle-preview":m.onPreview,onRemove:e(s)},Y({append:S(()=>[m.listType==="picture-card"?(f(),_(re,oe({key:0,ref_key:"uploadRef",ref:d},e(k)),{default:S(()=>[e(r).trigger?E(m.$slots,"trigger",{key:0}):h("v-if",!0),!e(r).trigger&&e(r).default?E(m.$slots,"default",{key:1}):h("v-if",!0)]),_:3},16)):h("v-if",!0)]),_:2},[m.$slots.file?{name:"default",fn:S(({file:i})=>[E(m.$slots,"file",{file:i})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):h("v-if",!0),m.listType!=="picture-card"?(f(),_(re,oe({key:1,ref_key:"uploadRef",ref:d},e(k)),{default:S(()=>[e(r).trigger?E(m.$slots,"trigger",{key:0}):h("v-if",!0),!e(r).trigger&&e(r).default?E(m.$slots,"default",{key:1}):h("v-if",!0)]),_:3},16)):h("v-if",!0),m.$slots.trigger?E(m.$slots,"default",{key:2}):h("v-if",!0),E(m.$slots,"tip"),!e(y)&&m.showFileList?(f(),_(le,{key:3,disabled:e(c),"list-type":m.listType,files:e(b),"handle-preview":m.onPreview,onRemove:e(s)},Y({_:2},[m.$slots.file?{name:"default",fn:S(({file:i})=>[E(m.$slots,"file",{file:i})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):h("v-if",!0)]))}});var Yt=H(Qt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload.vue"]]);const is=ee(Yt);export{is as E,rs as a};
