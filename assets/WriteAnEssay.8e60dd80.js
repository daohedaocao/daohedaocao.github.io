import{w as G,f as te,ah as oe,r as C,$ as ne,a0 as ie,c5 as re,aE as ue,a1 as W,a8 as $,ac as le,ae as se,ad as ce,Y as z,E as de,aj as me,o as U,k as T,D as w,H as v,p as I,F as L,bb as fe,l as B,bS as ve,a2 as H,aU as J,I as q,af as pe,ag as _e,G as K,bM as ge,m as Z,aa as Y}from"./index.6615d0be.js";import{E as ye}from"./el-tag.6c24c3c3.js";import{E as he,a as be}from"./el-progress.5531989a.js";import{E as F}from"./el-message.de0711cb.js";import{S as Ee}from"./SecondaryBg.4ec30e3b.js";import{a as Fe,u as Ce,c as Se}from"./article_upload.7ba9f481.js";import{e as we}from"./des_encryption.94420354.js";import"./use-dialog.0295def4.js";import"./request.15bb28a6.js";var Be=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],Ae=function(e){return Be.map(function(n){return n.toLowerCase()}).indexOf(e.toLowerCase())!==-1},ke=function(e,n,t){Object.keys(n).filter(Ae).forEach(function(r){var a=n[r];typeof a=="function"&&(r==="onInit"?a(e,t):t.on(r.substring(2),function(u){return a(u,t)}))})},De=function(e,n,t,r){var a=e.modelEvents?e.modelEvents:null,u=Array.isArray(a)?a.join(" "):a;G(r,function(s,f){t&&typeof s=="string"&&s!==f&&s!==t.getContent({format:e.outputFormat})&&t.setContent(s)}),t.on(u||"change input undo redo",function(){n.emit("update:modelValue",t.getContent({format:e.outputFormat}))})},xe=function(e,n,t,r,a,u){r.setContent(u()),t.attrs["onUpdate:modelValue"]&&De(n,t,r,a),ke(e,t.attrs,r)},Q=0,ae=function(e){var n=Date.now(),t=Math.floor(Math.random()*1e9);return Q++,e+"_"+t+Q+String(n)},Ie=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},X=function(e){return typeof e=="undefined"||e===""?[]:Array.isArray(e)?e:e.split(" ")},Ve=function(e,n){return X(e).concat(X(n))},je=function(e){return e==null},ee=function(){return{listeners:[],scriptId:ae("tiny-script"),scriptLoaded:!1}},Me=function(){var e=ee(),n=function(a,u,s,f){var o=u.createElement("script");o.referrerPolicy="origin",o.type="application/javascript",o.id=a,o.src=s;var h=function(){o.removeEventListener("load",h),f()};o.addEventListener("load",h),u.head&&u.head.appendChild(o)},t=function(a,u,s){e.scriptLoaded?s():(e.listeners.push(s),a.getElementById(e.scriptId)||n(e.scriptId,a,u,function(){e.listeners.forEach(function(f){return f()}),e.scriptLoaded=!0}))},r=function(){e=ee()};return{load:t,reinitialize:r}},Pe=Me(),Ue=function(){return typeof window!="undefined"?window:global},A=function(){var e=Ue();return e&&e.tinymce?e.tinymce:null},Le={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},k=globalThis&&globalThis.__assign||function(){return k=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++){n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},k.apply(this,arguments)},Oe=function(e,n,t,r){return e(r||"div",{id:n,ref:t})},Ne=function(e,n,t){return e("textarea",{id:n,visibility:"hidden",ref:t})},Re=te({props:Le,setup:function(e,n){var t=e.init?k({},e.init):{},r=oe(e),a=r.disabled,u=r.modelValue,s=r.tagName,f=C(null),o=null,h=e.id||ae("tiny-vue"),V=e.init&&e.init.inline||e.inline,j=!!n.attrs["onUpdate:modelValue"],M=!0,N=e.initialValue?e.initialValue:"",m="",P=function(i){return j?function(){return u!=null&&u.value?u.value:""}:function(){return i?N:m}},b=function(){var i=P(M),c=k(k({},t),{readonly:e.disabled,selector:"#"+h,plugins:Ve(t.plugins,e.plugins),toolbar:e.toolbar||t.toolbar,inline:V,setup:function(E){o=E,E.on("init",function(d){return xe(d,e,n,E,u,i)}),typeof t.setup=="function"&&t.setup(E)}});Ie(f.value)&&(f.value.style.visibility=""),A().init(c),M=!1};G(a,function(i){var c;o!==null&&(typeof((c=o.mode)===null||c===void 0?void 0:c.set)=="function"?o.mode.set(i?"readonly":"design"):o.setMode(i?"readonly":"design"))}),G(s,function(i){var c;j||(m=o.getContent()),(c=A())===null||c===void 0||c.remove(o),$(function(){return b()})}),ne(function(){if(A()!==null)b();else if(f.value&&f.value.ownerDocument){var i=e.cloudChannel?e.cloudChannel:"6",c=e.apiKey?e.apiKey:"no-api-key",E=je(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+c+"/tinymce/"+i+"/tinymce.min.js":e.tinymceScriptSrc;Pe.load(f.value.ownerDocument,E,b)}}),ie(function(){A()!==null&&A().remove(o)}),V||(re(function(){M||b()}),ue(function(){var i;j||(m=o.getContent()),(i=A())===null||i===void 0||i.remove(o)}));var D=function(i){var c;m=o.getContent(),(c=A())===null||c===void 0||c.remove(o),t=k(k({},t),i),$(function(){return b()})};return n.expose({rerender:D}),function(){return V?Oe(W,h,f,e.tagName):Ne(W,h,f)}}});const O=e=>(pe("data-v-d60991aa"),e=e(),_e(),e),ze={id:"writeanessay_container"},Te=O(()=>v("p",{class:"icon_title"},"\u70B9\u51FB\u4E0A\u4F20\u6587\u7AE0\u5C01\u9762",-1)),He=O(()=>v("p",{style:{"font-size":"1rem",position:"absolute",top:"100%"}},"\u4EC5\u652F\u6301 png,jpg,jpeg",-1)),qe=["src"],Ke={class:"arc_title"},Ge={class:"write_label"},Ye=O(()=>v("span",{style:{display:"block","text-align":"left",padding:"0.5rem 0 0.5rem 1rem"}},"\u6240\u9009\u6807\u7B7E",-1)),We={class:"write_labels"},$e={class:"write_labels_input"},Je=O(()=>v("span",{style:{display:"block","text-align":"left",padding:"0.5rem 0 0.5rem 1rem"}},"\u53EF\u9009\u6807\u7B7E",-1)),Ze={class:"writes_label_container"},Qe={class:"release_button"},Xe=Y("\u53D1\u5E03\u6587\u7AE0"),et=te({__name:"WriteAnEssay",setup(e){const n=C({cover_img:"https://s2.loli.net/2022/08/05/tqBjYT1hMsHR7Jg.jpg",title_one:"\u4E00\u751F\uFF0C\u4E00\u6761\u8DEF\uFF0C\u4E00\u4E2A\u4EBA\u8D70\uFF0C\u4E00\u4E2A\u4EBA\u609F\u3002",title_two:"\u5199\u6587\u7AE0"}),t=se(),r=ce(),a=C(""),u=C(!1);C(!1);let s=C("");const f="http://49.233.53.82:5000/rice/uploadarticlecover",o=t.getters["user/getValue"],h=z({name:o.rice_user.username,uid:o.rice_user.uid,tel:o.rice_user.tel}),V=d=>{d==="\u9519\u8BEF\uFF01"&&F({message:"\u4E0A\u4F20\u5931\u8D25\uFF01,\u53EF\u80FD\u662F\u56FE\u7247\u7684\u95EE\u9898,\u8BF7\u91CD\u8BD5\uFF01",type:"error"}),a.value=d.response.image_url,i.coverimg=d.response.image_url_min,F({message:"\u4E0A\u4F20\u6210\u529F\uFF01",type:"success"})},j=()=>{a.value="",F({message:"\u5220\u9664\u6210\u529F\uFF01",type:"success"})},M=()=>{F({message:"\u4E0A\u4F20\u5931\u8D25\uFF01\uFF01",type:"error"})},N=()=>{u.value=!0},m=C([]);ne(async()=>{const{lables:d}=await Fe();m.value=d});let P=C(0);const b=(d,_)=>{if(_){let g=m.value.findIndex(p=>p.name==d);m.value[g].state=!0,P.value=m.value.filter(p=>!p.state).length}else if(m.value.filter(g=>!g.state).length<3){let g=m.value.findIndex(p=>p.name==d);m.value[g].state=!1,P.value=m.value.filter(p=>!p.state).length}else alert("\u8D85\u51FA\u9009\u9879")};let D=z({html:"",text:""}),i=z({tel:"",uid:"",token:"",title:"",lable:[" "," "," "],coverimg:"https://s2.loli.net/2022/08/05/kYge92sNHZFEajB.jpg",content:""});const c=()=>{if(D.html!=""){const d=t.getters["user/getValue"];i.tel=d.rice_user.tel,i.uid=d.rice_user.uid,i.token=d.rice_user.token,i.title=s.value,i.content=we(D.html),i.lable=m.value.filter(y=>!y.state);const{tel:_,uid:g,token:p,title:x,lable:S,coverimg:R,content:l}=i;Ce({tel:_,uid:g,token:p,title:x,lable:S,coverimg:R,content:l}).then(y=>{y.result==200?(F({message:y.response,type:"success"}),setTimeout(()=>{r.push(`/layout/articles/${y.aid}`)},600)):F({message:y.response,type:"error"})}).catch(y=>{F({message:"\u51FA\u73B0\u9519\u8BEF,\u8BF7\u68C0\u67E5\u540E\u91CD\u8BD5\uFF01"+y,type:"error"})})}else F({message:"\u4EB2,\u6587\u7AE0\u5185\u5BB9\u4E0D\u53EF\u4E3A\u7A7A\u54E6 ~~",type:"error"})};let E={language_url:"./tinymce/langs/zh_CN.js",language:"zh_CN",placeholder:"\u5728\u8FD9\u91CC\u8F93\u5165\u6587\u5B57",toolbar_mod:"wrap",auto_focus:!0,custom_undo_redo_levels:20,mobile:{menubar:!0,plugins:["autosave","lists","autolink","bdmap","kityformula-editor","indent2em","lineheight","image","media","table"]},branding:!1,contextmenu:"backcolor forecolor bold copy charmap codesample emoticons image media preview insertdatetime searchreplace ",font_formats:"\u5FAE\u8F6F\u96C5\u9ED1=Microsoft YaHei,Helvetica Neue,PingFang SC,sans-serif;\u82F9\u679C\u82F9\u65B9=PingFang SC,Microsoft YaHei,sans-serif;\u5B8B\u4F53=simsun,serif",fontsize_formats:"11px 12px 14px 16px 18px 24px 36px 48px 56px 72px",fullscreen_native:!0,color_cols:5,plugins:["advlist","autolink","lists","link","image","charmap","preview","anchor","searchreplace","code","fullscreen","visualblocks","insertdatetime","media","table","help","wordcount","codesample","emoticons","insertdatetime","quickbars","bdmap","kityformula-editor","indent2em","lineheight"],toolbar1:" fullscreen undo redo  formatselect  bold italic backcolor forecolor             alignleft aligncenter alignright alignjustify  bullist numlist outdent indent  ",toolbar2:"indent2em lineheight removeformat hr  charmap codesample emoticons     image media  bdmap preview insertdatetime  searchreplace kityformula-editor|help",charmap_append:[[9749,"morning coffee"],[9728,"sun"],[9729,"cloud"]],quickbars_selection_toolbar:"bold italic | link h2 h3 h4 blockquote backcolor forecolor",quickbars_insert_toolbar:"quickimage quicktable",images_upload_handler:d=>new Promise((_,g)=>{let p=d.blob(),x=new FormData;x.append("img_file",p),Se(x).then(S=>{S.response.code=="200"?_(S.response.image_url_min):g("\u4E0A\u4F20\u5931\u8D25")})})};return(d,_)=>{const g=de,p=he,x=be,S=ye,R=me;return U(),T(H,null,[w(Ee,{secondary_data:n.value},null,8,["secondary_data"]),v("div",ze,[w(p,{action:f,"list-type":"picture-card",name:"img_file",data:h,"auto-upload":!0,"on-success":V,"on-remove":j,"on-preview":N,"on-error":M},{default:I(()=>[L(w(g,null,{default:I(()=>[w(B(ge)),Te,He]),_:1},512),[[K,a.value===""]])]),_:1},8,["data"]),w(x,{modelValue:u.value,"onUpdate:modelValue":_[0]||(_[0]=l=>u.value=l)},{default:I(()=>[v("img",{"w-full":"",src:a.value,alt:"Preview Image"},null,8,qe)]),_:1},8,["modelValue"]),v("div",Ke,[L(v("input",{"onUpdate:modelValue":_[1]||(_[1]=l=>ve(s)?s.value=l:s=l),class:"arc_title_input",type:"text",placeholder:"\u8BF7\u8F93\u5165\u6587\u7AE0\u6807\u9898..."},null,512),[[fe,B(s)]])]),w(B(Re),{modelValue:B(D).html,"onUpdate:modelValue":_[2]||(_[2]=l=>B(D).html=l),"api-key":"h8f98pdypo6nw0cszfeo8vk97gkvk92wxtwxmiz3e2e05gje",init:B(E),"tinymce-script-src":"./tinymce/tinymce.min.js",class:"editor_styles"},null,8,["modelValue","init"]),v("div",Ge,[Ye,v("div",We,[v("div",$e,[v("div",null,[(U(!0),T(H,null,J(m.value,l=>L((U(),Z(S,{key:l.name,class:"mx-1",closable:"",type:l.type,onClose:y=>b(l.name,!0)},{default:I(()=>[Y(q(l.name),1)]),_:2},1032,["type","onClose"])),[[K,!l.state]])),128))]),v("div",null,q(B(P))+"/3",1)])]),Je,v("div",Ze,[(U(!0),T(H,null,J(m.value,l=>L((U(),Z(S,{key:l.name,class:"mx-1",style:{margin:"0.5rem"},type:l.type,onClick:y=>b(l.name,!1)},{default:I(()=>[Y(q(l.name),1)]),_:2},1032,["type","onClick"])),[[K,l.state]])),128))])]),v("h3",Qe,[w(R,{type:"primary",onClick:c},{default:I(()=>[Xe]),_:1})])])],64)}}});var ct=le(et,[["__scopeId","data-v-d60991aa"]]);export{ct as default};
