import{w as Y,a as te,R as ae,r as F,H as ne,I as ie,b1 as re,aa as le,J as W,q as $,_ as ue,X as se,$ as ce,F as N,o as U,g as T,t as S,y as v,j as I,v as L,aE as de,u as w,i as me,K as q,as as J,z as H,Y as fe,Z as ve,x as K,h as Z,O as G}from"./index.d15ac50b.js";import{E as pe}from"./el-button.67644bca.js";import{E as _e}from"./el-tag.a0ce79f8.js";import{E as ge,a as ye}from"./el-progress.6417cd09.js";import"./el-overlay.b331af3f.js";/* empty css                   */import{E as he,K as be}from"./index.ac17342c.js";import{S as Ee}from"./SecondaryBg.37992ae9.js";import{a as Ce,u as Fe,c as Se}from"./article_upload.505bad41.js";import{e as we}from"./des_encryption.8161ee36.js";import{E as A}from"./index.30356878.js";import"./index.4af098ab.js";import"./index.9afde902.js";import"./focus-trap.b05075ab.js";import"./index.bff7b787.js";import"./isNil.98bb3b88.js";import"./typescript.72bf8adc.js";import"./request.9b527c98.js";var Ae=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],ke=function(e){return Ae.map(function(n){return n.toLowerCase()}).indexOf(e.toLowerCase())!==-1},Be=function(e,n,t){Object.keys(n).filter(ke).forEach(function(r){var o=n[r];typeof o=="function"&&(r==="onInit"?o(e,t):t.on(r.substring(2),function(l){return o(l,t)}))})},xe=function(e,n,t,r){var o=e.modelEvents?e.modelEvents:null,l=Array.isArray(o)?o.join(" "):o;Y(r,function(s,f){t&&typeof s=="string"&&s!==f&&s!==t.getContent({format:e.outputFormat})&&t.setContent(s)}),t.on(l||"change input undo redo",function(){n.emit("update:modelValue",t.getContent({format:e.outputFormat}))})},De=function(e,n,t,r,o,l){r.setContent(l()),t.attrs["onUpdate:modelValue"]&&xe(n,t,r,o),Be(e,t.attrs,r)},X=0,oe=function(e){var n=Date.now(),t=Math.floor(Math.random()*1e9);return X++,e+"_"+t+X+String(n)},Ie=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},Q=function(e){return typeof e=="undefined"||e===""?[]:Array.isArray(e)?e:e.split(" ")},Ve=function(e,n){return Q(e).concat(Q(n))},je=function(e){return e==null},ee=function(){return{listeners:[],scriptId:oe("tiny-script"),scriptLoaded:!1}},Pe=function(){var e=ee(),n=function(o,l,s,f){var a=l.createElement("script");a.referrerPolicy="origin",a.type="application/javascript",a.id=o,a.src=s;var h=function(){a.removeEventListener("load",h),f()};a.addEventListener("load",h),l.head&&l.head.appendChild(a)},t=function(o,l,s){e.scriptLoaded?s():(e.listeners.push(s),o.getElementById(e.scriptId)||n(e.scriptId,o,l,function(){e.listeners.forEach(function(f){return f()}),e.scriptLoaded=!0}))},r=function(){e=ee()};return{load:t,reinitialize:r}},Me=Pe(),Ue=function(){return typeof window!="undefined"?window:global},k=function(){var e=Ue();return e&&e.tinymce?e.tinymce:null},Le={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},B=globalThis&&globalThis.__assign||function(){return B=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++){n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},B.apply(this,arguments)},Oe=function(e,n,t,r){return e(r||"div",{id:n,ref:t})},Re=function(e,n,t){return e("textarea",{id:n,visibility:"hidden",ref:t})},ze=te({props:Le,setup:function(e,n){var t=e.init?B({},e.init):{},r=ae(e),o=r.disabled,l=r.modelValue,s=r.tagName,f=F(null),a=null,h=e.id||oe("tiny-vue"),V=e.init&&e.init.inline||e.inline,j=!!n.attrs["onUpdate:modelValue"],P=!0,R=e.initialValue?e.initialValue:"",d="",M=function(i){return j?function(){return l!=null&&l.value?l.value:""}:function(){return i?R:d}},b=function(){var i=M(P),c=B(B({},t),{readonly:e.disabled,selector:"#"+h,plugins:Ve(t.plugins,e.plugins),toolbar:e.toolbar||t.toolbar,inline:V,setup:function(E){a=E,E.on("init",function(m){return De(m,e,n,E,l,i)}),typeof t.setup=="function"&&t.setup(E)}});Ie(f.value)&&(f.value.style.visibility=""),k().init(c),P=!1};Y(o,function(i){var c;a!==null&&(typeof((c=a.mode)===null||c===void 0?void 0:c.set)=="function"?a.mode.set(i?"readonly":"design"):a.setMode(i?"readonly":"design"))}),Y(s,function(i){var c;j||(d=a.getContent()),(c=k())===null||c===void 0||c.remove(a),$(function(){return b()})}),ne(function(){if(k()!==null)b();else if(f.value&&f.value.ownerDocument){var i=e.cloudChannel?e.cloudChannel:"6",c=e.apiKey?e.apiKey:"no-api-key",E=je(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+c+"/tinymce/"+i+"/tinymce.min.js":e.tinymceScriptSrc;Me.load(f.value.ownerDocument,E,b)}}),ie(function(){k()!==null&&k().remove(a)}),V||(re(function(){P||b()}),le(function(){var i;j||(d=a.getContent()),(i=k())===null||i===void 0||i.remove(a)}));var x=function(i){var c;d=a.getContent(),(c=k())===null||c===void 0||c.remove(a),t=B(B({},t),i),$(function(){return b()})};return n.expose({rerender:x}),function(){return V?Oe(W,h,f,e.tagName):Re(W,h,f)}}});const O=e=>(fe("data-v-7784cd62"),e=e(),ve(),e),Ne={id:"writeanessay_container"},Te=O(()=>v("p",{class:"icon_title"},"\u70B9\u51FB\u4E0A\u4F20\u6587\u7AE0\u5C01\u9762",-1)),qe=O(()=>v("p",{style:{"font-size":"1rem",position:"absolute",top:"100%"}},"\u4EC5\u652F\u6301 png,jpg,jpeg",-1)),He=["src"],Ke={class:"arc_title"},Ye={class:"write_label"},Ge=O(()=>v("span",{style:{display:"block","text-align":"left",padding:"0.5rem 0 0.5rem 1rem"}},"\u6240\u9009\u6807\u7B7E",-1)),We={class:"write_labels"},$e={class:"write_labels_input"},Je=O(()=>v("span",{style:{display:"block","text-align":"left",padding:"0.5rem 0 0.5rem 1rem"}},"\u53EF\u9009\u6807\u7B7E",-1)),Ze={class:"writes_label_container"},Xe={class:"release_button"},Qe=G("\u53D1\u5E03\u6587\u7AE0"),et=te({__name:"WriteAnEssay",setup(e){const n=F({cover_img:"https://s2.loli.net/2022/08/05/tqBjYT1hMsHR7Jg.jpg",title_one:"\u4E00\u751F\uFF0C\u4E00\u6761\u8DEF\uFF0C\u4E00\u4E2A\u4EBA\u8D70\uFF0C\u4E00\u4E2A\u4EBA\u609F\u3002",title_two:"\u5199\u6587\u7AE0"}),t=se(),r=ce(),o=F(""),l=F(!1);F(!1);let s=F("");const f="https://49.233.53.82:5000/rice/uploadarticlecover",a=t.getters["user/getValue"],h=N({name:a.rice_user.username,uid:a.rice_user.uid,tel:a.rice_user.tel}),V=m=>{o.value=m.response.image_url,i.coverimg=m.response.image_url_min,A({message:"\u4E0A\u4F20\u6210\u529F\uFF01",type:"success"})},j=()=>{o.value="",A({message:"\u5220\u9664\u6210\u529F\uFF01",type:"success"})},P=()=>{A({message:"\u4E0A\u4F20\u5931\u8D25\uFF01\uFF01",type:"error"})},R=()=>{l.value=!0,console.log(o)},d=F([]);ne(async()=>{const{lables:m}=await Ce();d.value=m});let M=F(0);const b=(m,_)=>{if(_){let g=d.value.findIndex(p=>p.name==m);d.value[g].state=!0,M.value=d.value.filter(p=>!p.state).length}else if(d.value.filter(g=>!g.state).length<3){let g=d.value.findIndex(p=>p.name==m);d.value[g].state=!1,M.value=d.value.filter(p=>!p.state).length}else alert("\u8D85\u51FA\u9009\u9879")};let x=N({html:"",text:""}),i=N({tel:"",uid:"",token:"",title:"",lable:[" "," "," "],coverimg:"https://s2.loli.net/2022/08/05/kYge92sNHZFEajB.jpg",content:""});const c=()=>{if(x.html!=""){const m=t.getters["user/getValue"];i.tel=m.rice_user.tel,i.uid=m.rice_user.uid,i.token=m.rice_user.token,i.title=s.value,i.content=we(x.html),i.lable=d.value.filter(y=>!y.state);const{tel:_,uid:g,token:p,title:D,lable:C,coverimg:z,content:u}=i;Fe({tel:_,uid:g,token:p,title:D,lable:C,coverimg:z,content:u}).then(y=>{y.result==200?(A({message:y.response,type:"success"}),setTimeout(()=>{r.push(`/layout/articles/${y.aid}`)},600)):A({message:y.response,type:"error"})}).catch(y=>{A({message:"\u51FA\u73B0\u9519\u8BEF,\u8BF7\u68C0\u67E5\u540E\u91CD\u8BD5\uFF01"+y,type:"error"})})}else A({message:"\u4EB2,\u6587\u7AE0\u5185\u5BB9\u4E0D\u53EF\u4E3A\u7A7A\u54E6 ~~",type:"error"})};let E={language_url:"./tinymce/langs/zh_CN.js",language:"zh_CN",placeholder:"\u5728\u8FD9\u91CC\u8F93\u5165\u6587\u5B57",toolbar_mod:"wrap",auto_focus:!0,custom_undo_redo_levels:20,mobile:{menubar:!0,plugins:["autosave","lists","autolink","bdmap","kityformula-editor","indent2em","lineheight","image","media","table"]},branding:!1,contextmenu:"backcolor forecolor bold copy charmap codesample emoticons image media preview insertdatetime searchreplace ",font_formats:"\u5FAE\u8F6F\u96C5\u9ED1=Microsoft YaHei,Helvetica Neue,PingFang SC,sans-serif;\u82F9\u679C\u82F9\u65B9=PingFang SC,Microsoft YaHei,sans-serif;\u5B8B\u4F53=simsun,serif",fontsize_formats:"11px 12px 14px 16px 18px 24px 36px 48px 56px 72px",fullscreen_native:!0,color_cols:5,plugins:["advlist","autolink","lists","link","image","charmap","preview","anchor","searchreplace","code","fullscreen","visualblocks","insertdatetime","media","table","help","wordcount","codesample","emoticons","insertdatetime","quickbars","bdmap","kityformula-editor","indent2em","lineheight"],toolbar1:" fullscreen undo redo  formatselect  bold italic backcolor forecolor             alignleft aligncenter alignright alignjustify  bullist numlist outdent indent  ",toolbar2:"indent2em lineheight removeformat hr  charmap codesample emoticons     image media  bdmap preview insertdatetime  searchreplace kityformula-editor|help",charmap_append:[[9749,"morning coffee"],[9728,"sun"],[9729,"cloud"]],quickbars_selection_toolbar:"bold italic | link h2 h3 h4 blockquote backcolor forecolor",quickbars_insert_toolbar:"quickimage quicktable",images_upload_handler:m=>new Promise((_,g)=>{let p=m.blob();console.log(p);let D=new FormData;D.append("img_file",p),Se(D).then(C=>{console.log(C),C.response.code=="200"?_(C.response.image_url_min):g("\u4E0A\u4F20\u5931\u8D25")})})};return(m,_)=>{const g=he,p=ge,D=ye,C=_e,z=pe;return U(),T(q,null,[S(Ee,{secondary_data:n.value},null,8,["secondary_data"]),v("div",Ne,[S(p,{action:f,"list-type":"picture-card",name:"img_file",data:h,"auto-upload":!0,"on-success":V,"on-remove":j,"on-preview":R,"on-error":P},{default:I(()=>[L(S(g,null,{default:I(()=>[S(w(be)),Te,qe]),_:1},512),[[K,o.value===""]])]),_:1},8,["data"]),S(D,{modelValue:l.value,"onUpdate:modelValue":_[0]||(_[0]=u=>l.value=u)},{default:I(()=>[v("img",{"w-full":"",src:o.value,alt:"Preview Image"},null,8,He)]),_:1},8,["modelValue"]),v("div",Ke,[L(v("input",{"onUpdate:modelValue":_[1]||(_[1]=u=>me(s)?s.value=u:s=u),class:"arc_title_input",type:"text",placeholder:"\u8BF7\u8F93\u5165\u6587\u7AE0\u6807\u9898..."},null,512),[[de,w(s)]])]),S(w(ze),{modelValue:w(x).html,"onUpdate:modelValue":_[2]||(_[2]=u=>w(x).html=u),"api-key":"h8f98pdypo6nw0cszfeo8vk97gkvk92wxtwxmiz3e2e05gje",init:w(E),"tinymce-script-src":"./tinymce/tinymce.min.js",class:"editor_styles"},null,8,["modelValue","init"]),v("div",Ye,[Ge,v("div",We,[v("div",$e,[v("div",null,[(U(!0),T(q,null,J(d.value,u=>L((U(),Z(C,{key:u.name,class:"mx-1",closable:"",style:{"margin-left":"0.5rem"},type:u.type,onClose:y=>b(u.name,!0)},{default:I(()=>[G(H(u.name),1)]),_:2},1032,["type","onClose"])),[[K,!u.state]])),128))]),v("div",null,H(w(M))+"/3",1)])]),Je,v("div",Ze,[(U(!0),T(q,null,J(d.value,u=>L((U(),Z(C,{key:u.name,class:"mx-1",style:{cursor:"pointer",margin:"0.5rem"},type:u.type,onClick:y=>b(u.name,!1)},{default:I(()=>[G(H(u.name),1)]),_:2},1032,["type","onClick"])),[[K,u.state]])),128))])]),v("h3",Xe,[S(z,{type:"primary",onClick:c},{default:I(()=>[Qe]),_:1})])])],64)}}});var ht=ue(et,[["__scopeId","data-v-7784cd62"]]);export{ht as default};
